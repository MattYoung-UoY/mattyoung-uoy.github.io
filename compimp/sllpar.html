<!DOCTYPE html>
<html lang="en-GB">

	<head>		
		<title alt="Project Showcase. Matt Young.">Project Showcase - Matt Young</title>
		<link rel="stylesheet" href="../stylesheet.css">
		<script src="../navbar.js"></script>
		<meta charset="UTF-8">
	</head>

	<body onload="load()" onresize="resize()" onscroll="update()">
		<div id="titleBar">
			<a id="title"  href="../index.html"><h1 alt="Project Showcase. Matt Young.">Project Showcase - Matt Young</h1></a>
		</div>
		<div id="navbar">
			<ul>
				<a href="../index.html"><li>Home</li></a>
				<a href="../projects.html"><li>Projects</li></a>
			</ul>
		</div>
		<div id="content"><br/>
			<h2 id="title">Straight-Line Language Parser</h2><br/>
			
			<h3>Setup:</h3><br/>
			I downloaded the <a href="https://www.cs.princeton.edu/~appel/modern/java/chap3/" id="niceln">skeleton code</a> as per usual. 
			I then set this up in an Eclipse environment.<br/><br/>
			
			<h3>Part 1 - Parser Specification:</h3><br/>
			I needed to set up a CUP specification that would produce the grammar for the Straight-Line Language(SLL). 
			This is easier said than done, as the grammar that is given to CUP (should) be unambiguous.
			As can be seen from the specification of the SLL in the <a href="cp1ex.html" id="niceln">SLL Interpreter</a>, the grammar production representing an Expression to an Arithmatic Operation is ambiguous:<br/><br/>
			
			<div id="formcontainer">
				<div id="formulabox">
					Exp -> Exp Binop Exp
				</div>
			</div><br/>
			
			This is the case as there are two different Parse Trees for the expression:<br/><br/>
			
			<div id="formcontainer">
				<div id="formulabox">
					1 + 1 + 1
				</div>
			</div><br/>
			
			This expression can be parsed in two different ways:<br/><br/>
			
			<div id="formcontainer">
				<div id="formulabox">
					(Exp Binop Exp) Binop Exp<br/>
					Exp Binop (Exp Binop Exp)
				</div>
			</div><br/>
	
			hence the ambiguity.<br/>
			We also have this issue with the grammar production that takes a Statement and produces a list of Statements:<br/><br/>

			<div id="formcontainer">
				<div id="formulabox">
					Stm -> Stm ; Stm
				</div>
			</div><br/>
			
			The expressions that produce multiple different Parse Trees for this grammar production are of the same form as above and trivial, therefore I won't repeat my logic for this one as well.
			Hopefully the reader is able to see that this grammar production is also a cause of ambiguity in the grammar.<br/>
			
			When CUP reads these grammar productions, it does not know which method of parsing to use (the decision is Non-Deterministic).
			To fix this, we need to rewrite the grammar to be unambiguous.<br/>
			To fix the list of statements issue, I replace the above grammar production with:<br/><br/>
			
			<div id="formcontainer">
				<div id="formulabox">
					StmList -> Stm ; StmList<br/>
					StmList -> 
				</div>
			</div><br/>
			
			with StmList as the new starting Non-Terminal for the grammar.<br/>
			With a little mental gymnastics, the reader should be able to see how the Statement:<br/><br/>
			
			<div id="formcontainer">
				<div id="formulabox">
					Stm ; Stm ; Stm
				</div>
			</div><br/>
			
			now only has one Parse Tree, and therefore does not produce any ambiguity in the grammar.<br/>
			The case for the Arithmatic Operations is a little more complicated.
			The approach I take uses the concept of coercions from another tool called <a href="#" id="niceln">BNFC</a>.<br/>
			The following is the resulting grammar productions related to arithmatic expressions:<br/><br/>
			
			<div id="formcontainer">
				<div id="formulabox">
					exp -> exp SUB exp2<br/>
					exp -> exp2<br/>
					<br/>
					exp2 -> exp2 PLUS exp3<br/>
					exp2 -> exp3<br/>
					<br/>
					exp3 -> exp3 DIV exp4<br/>
					exp3 -> exp4<br/>
					<br/>
					exp4 -> exp4 MULT exp5<br/>
					exp4 -> exp5<br/>
					<br/>
					exp5 -> ID<br/>
					exp5 -> INT<br/>
				</div>
			</div><br/>
			
			This method not only produces a non-ambiguous grammar, but also provides a method of providing precedence for the different operators.
			However, at this stage, I cannot visualise how this ordering of the coercions will affect the resulting precedences, and so I will make adjustments after creating the system to create the Abstract Syntax Tree.<br/>
			After this, implementing the remaining grammar productions was trivial.
			If the reader wishes to view the final grammar specification, they can find it at <i>Striaght Line Language Implementation/src/parser/SllParser.cup</i><br/>
			I then generated the Java code using the CUP tool, and made some modifications to the resulting files to work with my project setup.<br/><br/>
			
			<h3>Part 2 - Abstract Syntax Tree Generation:</h3><br/>
			
			Now that I have a working parser, I need to implement the Semantic Actions to generate an Abstract Syntax Tree.<br/>
			The Semantic Actions are pieces of Java code that are specified alongside grammar productions in the CUP specification.
			They get executed whenever the production rule gets "used" by the parser, and so are perfect for generating the Abstract Syntax Tree.<br/>
			My first task is to decide which grammar productions need to produce nodes on the Abstract Syntax Tree. My decisions for which productions, and their corresponding values in the abstract syntax tree are shown here:<br/><br/>
			
			<div id="formcontainer">
				<div id="formulabox">
					stmList -> stm SEMICOLON stmList<br/>
					Statement<br/>
					<br/>
					stm -> assignID ASSIGN exp<br/>
					Assignment<br/>
					<br/>
					stm -> PRINT LPAREN expList RPAREN<br/>
					Print<br/>
					<br/>
					assignID -> ID<br/>
					ID<br/>
					<br/>
					exp -> exp SUB exp2<br/>
					Subtract<br/>
					<br/>
					exp2 -> exp2 PLUS exp3<br/>
					Plus<br/>
					<br/>
					exp3 -> exp3 DIV exp4<br/>
					Divide<br/>
					<br/>
					exp4 -> exp4 MULT exp5<br/>
					Multiply<br/>
					<br/>
					exp5 -> ID<br/>
					ID<br/>
					<br/>
					exp5 -> INT<br/>
					Int<br/>
					<br/>
					exp -> LPAREN stm COMMA exp RPAREN<br/>
					ExpSeq<br/>
					<br/>
					expList -> exp COMMA expList<br/>
					ExpList<br/>
				</div>
			</div><br/>
			
		</div>
	</body>

</html>